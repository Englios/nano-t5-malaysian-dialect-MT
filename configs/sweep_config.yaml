program: src/trainer.py
command:
  - uv
  - run
  - ${program}
  - configs/train_config_sweep.yaml

method: bayes 
max_runs: 5  # Maximum number of runs for this sweep

metric:
  name: eval_bleu 
  goal: maximize 

parameters:
  learning_rate:
    values: [1.0e-5, 2.0e-5, 3.0e-5, 5.0e-5, 7.0e-5, 1.0e-4]
  
  per_device_train_batch_size:
    values: [4, 8, 16]
  
  weight_decay:
    values: [0.001, 0.003, 0.01, 0.03, 0.1]
  
  warmup_steps:
    distribution: int_uniform
    min: 50
    max: 300  
  
  num_train_epochs:
    values: [2, 3, 4]  # Fewer epochs for faster trials
  
  gradient_accumulation_steps:
    values: [1, 2, 4]
  
  max_source_length:
    values: [512, 800, 1024]

early_terminate:
  type: hyperband
  min_iter: 1
  max_iter: 3  
  s: 2  

project: ml_eng_meso-nano_t5_small
name: ml_eng_meso-nano_t5_small-sweep
description: Hyperparameter sweep for mesolitica/nanot5-small-malaysian-cased dialect translation model
